<!-- templates/menu.html -->
<header>
  <div class="logo">CAILLA</div>
  <nav>
    <ul>
      {% if session.get('is_admin') %}
        <li><a href="{{ url_for('admin_produtos') }}">Painel Admin</a></li>
        <a href="{{ url_for('logout') }}" onclick="return confirm('VocÃª deseja sair?')">Sair</a>
      {% else %}
        <li><a href="{{ url_for('home') }}">Home</a></li>
        <li><a href="{{ url_for('loja') }}">Loja</a></li>
        <li><a href="{{ url_for('sobre') }}">Sobre</a></li>
        <li><a href="{{ url_for('membros') }}">Membros</a></li>
        <li><a href="{{ url_for('contato') }}">Contato</a></li>
        <li><a href="{{ url_for('wishlist') }}">Favoritos</a></li>
        <li><a href="{{ url_for('blog') }}">Blog</a></li>

        <li style="position: relative;">
          <a href="{{ url_for('show_cart') }}" title="Carrinho" id="cart-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="menu-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="21" r="1" />
              <circle cx="20" cy="21" r="1" />
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
            </svg>
            <span id="cart-count" class="carrinho-badge" style="{% if not session.get('cart') %}display: none;{% endif %}">
              {{ session.cart | map(attribute='quantidade') | sum if session.get('cart') else '' }}
            </span>
          </a>

          <div class="cart-preview" id="cart-preview" style="display: none;">
  {% if session.get('cart') and session.cart|length > 0 %}
    {% for item in session.cart[:3] %}
      <div class="cart-item-preview">
        <img src="{{ url_for('static', filename='assets/' ~ item.imagem) }}" alt="{{ item.nome }}">
        <div>
          <p class="nome">{{ item.nome }}</p>
          <p>{{ item.quantidade }}x - R$ {{ (item.preco * item.quantidade) | round(2) | string | replace('.', ',') }}</p>
        </div>
      </div>
    {% endfor %}
    <a href="{{ url_for('show_cart') }}" class="ver-carrinho">Ver Carrinho</a>
  {% else %}
    <div class="carrinho-vazio">
      <p>Seu carrinho estÃ¡ vazio ðŸ›’</p>
    </div>
  {% endif %}
</div>

        </li>

        <li class="usuario-logado">
  {% if session.get('usuario_id') %}
    <a href="{{ url_for('conta') }}">OlÃ¡, {{ session.get('nome_usuario', '').split()[0] }}</a>
    <a href="{{ url_for('logout') }}" class="logout-link" onclick="return confirm('VocÃª deseja sair?')">Sair</a>
          {% else %}
            <a href="{{ url_for('login') }}" title="Minha Conta">
              <svg xmlns="http://www.w3.org/2000/svg" class="menu-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-3-3.87" />
                <path d="M4 21v-2a4 4 0 0 1 3-3.87" />
                <circle cx="12" cy="7" r="4" />
              </svg>
            </a>
          {% endif %}
        </li>
      {% endif %}
    </ul>
  </nav>

  <script src="{{ url_for('static', filename='js/carrinho.js') }}"></script>
</header>
